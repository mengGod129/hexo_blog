<!DOCTYPE html>
<html class="meng.me">

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">

    
    <title>Hexo部署至云服务器（Git配置） | MENG.ME</title>

    <meta name="description" content="&lt;p&gt;先给大家看个日志：&lt;br&gt;&lt;img src=&#34;/postsImages/hexo-git-1.jpg&#34; alt=&#34;image&#34;&gt;&lt;br&gt;一定要注意，安全无小事，密码切勿使用安全级别较低的密码。&lt;/p&gt;">
    <meta name="keywords" content="Meng,mengBlog">

    

    <meta property="og:locale" content="cn" />
    <meta property="og:type" content="article" />
    <meta property="og:title" content= "Hexo部署至云服务器（Git配置） | MENG.ME"  />
    <meta property="og:description" content= "&lt;p&gt;先给大家看个日志：&lt;br&gt;&lt;img src=&#34;/postsImages/hexo-git-1.jpg&#34; alt=&#34;image&#34;&gt;&lt;br&gt;一定要注意，安全无小事，密码切勿使用安全级别较低的密码。&lt;/p&gt;" />
    <meta property="og:url" content="https://www.meng.me/posts/7714.html" />
    <meta property="og:site_name" content="" />
    <meta property="article:author" content="Meng" />
    <meta property="article:publisher" content="" />
    <meta property="og:description" content="&lt;p&gt;先给大家看个日志：&lt;br&gt;&lt;img src=&#34;/postsImages/hexo-git-1.jpg&#34; alt=&#34;image&#34;&gt;&lt;br&gt;一定要注意，安全无小事，密码切勿使用安全级别较低的密码。&lt;/p&gt;" />
    <meta name="twitter:title" content="Hexo部署至云服务器（Git配置） | MENG.ME"/>
    <meta name="twitter:description" content="&lt;p&gt;先给大家看个日志：&lt;br&gt;&lt;img src=&#34;/postsImages/hexo-git-1.jpg&#34; alt=&#34;image&#34;&gt;&lt;br&gt;一定要注意，安全无小事，密码切勿使用安全级别较低的密码。&lt;/p&gt;"/>
    <script type="application/ld+json">
        {
            "description": "&lt;p&gt;先给大家看个日志：&lt;br&gt;&lt;img src=&#34;/postsImages/hexo-git-1.jpg&#34; alt=&#34;image&#34;&gt;&lt;br&gt;一定要注意，安全无小事，密码切勿使用安全级别较低的密码。&lt;/p&gt;",
            "author": { "@type": "Person", "name": "Meng" },
            "@type": "BlogPosting",
            "url": "https://www.meng.me/posts/7714.html",
            "publisher": {
            "@type": "Organization",
            "logo": {
                "@type": "ImageObject",
                "url": "https://www.meng.me/images/avatar.png"
            },
            "name": "Meng"
            },
            "headline": "Hexo部署至云服务器（Git配置） | MENG.ME",
            "datePublished": "2022-12-18T12:51:31.000Z",
            "mainEntityOfPage": {
                "@type": "WebPage",
                "@id": "https://www.meng.me/posts/7714.html"
            },
            "@context": "http://schema.org"
        }
    </script>




    

    

    

    
    <link rel="icon" href="/images/favicon.ico">
    

    

    

    

    
        <link rel="stylesheet" href="https://npm.elemecdn.com/mengblog@1.0.2/css/waline-meta.css" />
        <link rel="stylesheet" href="https://npm.elemecdn.com/mengblog@1.0.2/css/waline.css" />
    

    
<link rel="stylesheet" href="/dist/build.css?v=1654266144177.css">


    
<link rel="stylesheet" href="/dist/custom.css?v=1654266144177.css">


    <script>
        window.isPost = true
        window.aomori = {
            
            
            
            waline: {
                enable: true,
                serverURL: "https://meng.eg3.cn",
                search: false,
            },
            
            
        }
        window.aomori_logo_typed_animated = true
        window.aomori_search_algolia = false

    </script>

<meta name="generator" content="Hexo 5.4.2"></head>

<body>

    <div class="container">
    <header class="header">
        <div class="header-type">
            
            <div class="header-type-avatar avatar avatar-sm">
                <img src="/images/avatar.png" alt="Meng">
            </div>
            
            <div class="header-type-inner">
                
                    <div id="typed-strings" style="display:none">
                        <p>MENG.ME</p>
                    </div>
                    <a class="header-type-title" id="typed" href="/"></a>
                
    
                
            </div>
        </div>
        <div class="header-menu">
            <div class="header-menu-inner">
                
                <a href="/">🏡首页</a>
                
                <a href="/archives/">📚归档</a>
                
                <a href="/laboratory/">🚀实验室</a>
                
                <a href="/photography/">🌆摄影</a>
                
                <a href="/friends/">🌍友联</a>
                
                <a href="/message/">💬留言</a>
                
                <a href="/about/">🌸关于</a>
                
            </div>
            <div class="header-menu-social">
                
    <a class="social" target="_blank" href="https://github.com/mengGods">
        <ion-icon name="logo-github"></ion-icon>
    </a>

    <a class="social" target="_blank" href="mailto:me@meng.me">
        <ion-icon name="mail-outline"></ion-icon>
    </a>

    <a class="social" target="_blank" href="/sitemap.xml">
        <ion-icon name="logo-rss"></ion-icon>
    </a>

            </div>
        </div>

        <div class="header-menu-mobile">
            <div class="header-menu-mobile-inner" id="mobile-menu-open">
                <i class="icon icon-menu"></i>
            </div>
        </div>
    </header>

    <div class="header-menu-mobile-menu">
        <div class="header-menu-mobile-menu-bg"></div>
        <div class="header-menu-mobile-menu-wrap">
            <div class="header-menu-mobile-menu-inner">
                <div class="header-menu-mobile-menu-close" id="mobile-menu-close">
                    <i class="icon icon-cross"></i>
                </div>
                <div class="header-menu-mobile-menu-list">
                    
                    <a href="/">🏡首页</a>
                    
                    <a href="/archives/">📚归档</a>
                    
                    <a href="/laboratory/">🚀实验室</a>
                    
                    <a href="/photography/">🌆摄影</a>
                    
                    <a href="/friends/">🌍友联</a>
                    
                    <a href="/message/">💬留言</a>
                    
                    <a href="/about/">🌸关于</a>
                    
                </div>
            </div>
        </div>
    </div>

</div>
    <div class="index-meng"></div>
    <div class="container">
        <div class="main">
            <section class="inner">
                <section class="inner-main">
                    <div class="post">
    <article id="post-clbuz7tbb0001nuq67syde6uo" class="article article-type-post" itemscope
    itemprop="blogPost">

    <div class="article-inner">

        
          
        
        
        

        
        <header class="article-header">
            
  
    <h1 class="article-title" itemprop="name">
      Hexo部署至云服务器（Git配置）
    </h1>
  

        </header>
        

        <div class="article-more-info article-more-info-post hairline">

            <div class="article-date">
  <time datetime="2022-12-18T12:51:31.000Z" itemprop="datePublished">2022-12-18</time>
</div>

            

            

            

        </div>

        <div class="article-entry post-inner-html hairline" itemprop="articleBody">
            <p>先给大家看个日志：<br><img src="/postsImages/hexo-git-1.jpg" alt="image"><br>一定要注意，安全无小事，密码切勿使用安全级别较低的密码。</p>
<span id="more"></span>
<p>因为我只是搭建git服务测试，所以使用的密码很简单，他就成功登录上来了。<br>随后，这个人又尝试了gitlab、emqx、mc等等常用用户名登录。<br><img src="/postsImages/hexo-git-2.jpg" alt="image"><br>我是用一台新服务器搭建测试，还好服务器没有什么资料等，而且此用户也是没有root权限的，之所以会发现这个问题还是因为腾讯云的预警。<br><img src="/postsImages/hexo-git-3.jpg" alt="image"><br>经过工单咨询和腾讯云工程师进一步确认得知：<br>1、确认服务器被入侵且存在异常脚本程序。<br>2、确认服务器内存在挖矿相关病毒程序。<br>3、确认服务器正在请求高危命令。<br>以上就不展开说了，所以各位密码一定要使用高强度密码，哪怕是自己忘记需要重置密码，其实这也是变相的定期修改密码。<br>好了，正文开始：</p>
<hr>
<h2 id="本地准备"><a href="#本地准备" class="headerlink" title="本地准备"></a>本地准备</h2><p>相信大家都会把hexo部署至github，本文的思路是一样的，在云服务器建立git仓库用于存储public代码，然后通过nginx指定此目录来访问。</p>
<h3 id="生成ssh密钥"><a href="#生成ssh密钥" class="headerlink" title="生成ssh密钥"></a>生成ssh密钥</h3><p>请确认自己有没有生成ssh密钥，如果没有则执行一下命令：</p>
<blockquote>
<p>查看有没有 ~/.ssh 这个文件夹，其中id_rsa.pub则为公钥。<br>windows用户在：<code>C:\Users\yourname\.ssh</code></p>
</blockquote>
<pre><code>git config --global user.name &quot;你的用户名&quot;
git config --global user.email &quot;你的的邮箱&quot;
ssh-keygen -t rsa -C &quot;你的的邮箱&quot;
</code></pre>
<h2 id="服务器搭建"><a href="#服务器搭建" class="headerlink" title="服务器搭建"></a>服务器搭建</h2><h3 id="root账号操作部分"><a href="#root账号操作部分" class="headerlink" title="root账号操作部分"></a>root账号操作部分</h3><p>1、切换到root账号</p>
<pre><code>su root
</code></pre>
<p>如果你登录的就是root账号则无需切换。<br>2、 安装git<br>请先检查是否安装git，如果安装了就不用安装了。</p>
<blockquote>
<p>执行<code>git --version</code>，如果提醒git command not found就是没安装</p>
</blockquote>
<pre><code>yum install git
</code></pre>
<p>3、 创建git账户并设置密码</p>
<pre><code>adduser git
passwd git
</code></pre>
<blockquote>
<p>小白提醒：设置密码时，密码时不显示的，不是你键盘坏了。new password后他会提示你再次输入的，也是一样的。</p>
</blockquote>
<ol start="4">
<li>赋予权限<pre><code>chmod 740 /etc/sudoers
</code></pre>
5、 编辑 /etc/sudoers 文件<pre><code>vim /etc/sudoers
</code></pre>
在<code>root ALL=(ALL) ALL</code>下一行加入：<pre><code>git     ALL=(ALL)     ALL
</code></pre>
6、 把权限改回来<pre><code>chmod 400 /etc/sudoers
</code></pre>
</li>
</ol>
<h3 id="git账号操作部分"><a href="#git账号操作部分" class="headerlink" title="git账号操作部分"></a>git账号操作部分</h3><p>1、创建.ssh文件夹</p>
<pre><code>su git
cd ~
mkdir .ssh
cd .ssh
</code></pre>
<p>2、创建git密钥</p>
<pre><code>ssh-keygen
</code></pre>
<p>3、复制一份公钥</p>
<pre><code>cp id_rsa.pub authorized_keys
</code></pre>
<p>4、修改权限</p>
<pre><code>chmod 600 ~/.ssh/authorized_keys
chmod 700 ~/.ssh
</code></pre>
<p>5、上传本地公钥<br>把本文第一步生成的<code>id_rsa.pub</code>内容拷贝到服务器的<code>authorized_keys</code>文件末尾即可。<br>6、本地cmd测试<br>你在本地打开命令行工具输入：</p>
<pre><code>ssh -v git@云服务器的公网IP
</code></pre>
<p>免密登录即ok</p>
<h3 id="创建git仓库"><a href="#创建git仓库" class="headerlink" title="创建git仓库"></a>创建git仓库</h3><blockquote>
<p>注意：这里依然是git账号操作</p>
</blockquote>
<p>1、初始化git仓库<br>创建位置自己选择，我这演示创建在<code>/home/git</code>下</p>
<pre><code>cd ~
git init --bare mengblog.git
</code></pre>
<p>2、创建git钩子</p>
<pre><code>vim ~/mengblog.git/hooks/post-receive
</code></pre>
<p>输入以下内容：</p>
<pre><code>git --work-tree=/home/git/blog --git-dir=/home/git/mengblog.git checkout -f
</code></pre>
<p>这里的目录自行选择，我这里是<code>/home/git/blog</code><br>3、设置文件可执行权限</p>
<pre><code>chmod +x ~/mengblog.git/hooks/post-receive
</code></pre>
<h3 id="配置nginx"><a href="#配置nginx" class="headerlink" title="配置nginx"></a>配置nginx</h3><p>这一步只需要修改nginx配置中相应的server服务：</p>
<pre><code>root /home/git/blog;
</code></pre>
<h2 id="博客配置"><a href="#博客配置" class="headerlink" title="博客配置"></a>博客配置</h2><p>其实这里就简单了，和github一样，把_config.yml文件中deploy&gt;repo地址改成：</p>
<pre><code>git@云服务器公网IP:/home/git/mengblog.git
</code></pre>
<p>然后<code>hexo d</code>就行了</p>
<h2 id="完成"><a href="#完成" class="headerlink" title="完成"></a>完成</h2><p>到这里你只需要去访问nginx相应server绑定的域名即可。<br>在上一步中，<code>hexo d</code>可能会出现被拒绝等问题，如果你按照文章一步一步走的，那可能是在账号使用那一块出现了问题。<br>注意你的<code>/home/git/blog</code>所有者是不是<code>git</code>，如果不是请修改成<code>git</code></p>

        </div>

    </div>

    

    

    

    
  <div class="article-copyright hairline">
    <p>
      本作品采用  <a rel="license noopener" target="_blank" href="http://creativecommons.org/licenses/by-nc-nd/4.0/">知识共享署名-非商业性使用-禁止演绎 4.0 国际许可协议 (CC BY-NC-ND 4.0)</a> 进行许可。
    </p>
  </div>
  

    

    
<nav class="article-nav">
  
  
    <a href="/posts/23045.html" id="article-nav-older" class="article-nav-link-wrap">
      <div class="article-nav-caption">上一篇</div>
      <div class="article-nav-title">NPM包发布、更新、撤销</div>
    </a>
  
</nav>


    <!-- <section class="share">
        <div class="share-title">分享</div>
        <a class="share-item" target="_blank"
            href="https://twitter.com/share?text=Hexo部署至云服务器（Git配置） - MENG.ME&url=https%3A%2F%2Fwww.meng.me%2Fposts%2F7714.html">
            <ion-icon name="logo-twitter"></ion-icon>
        </a>
        <a class="share-item" target="_blank"
            href="https://www.facebook.com/sharer.php?title=Hexo部署至云服务器（Git配置） - MENG.ME&u=https%3A%2F%2Fwww.meng.me%2Fposts%2F7714.html">
            <ion-icon name="logo-facebook"></ion-icon>
        </a> -->
        <!-- <a class="share-item" target="_blank"
            href="https://service.weibo.com/share/share.php?title=Hexo部署至云服务器（Git配置） - MENG.ME&url=https://www.meng.me/posts/7714.html&pic=">
            <div class="n-icon n-icon-weibo"></div>
        </a> -->
    <!-- </section> -->

</article>












<section class="comments">
    <div id="waline-container"></div>
</section>
<script type="module" src="/javascripts/waline.js"></script>







</div>
                </section>
            </section>

            
            <aside class="sidebar ">
                


<div class="widget" id="widget">
    
      
  <div class="widget-wrap">
    <div class="widget-inner">
      <div class="toc post-toc-html"></div>
    </div>
  </div>

    
      
  <div class="widget-wrap widget-tags">
    <div class="widget-title"><span>Tags</span></div>
    <div class="widget-inner">
      <ul class="tag-list" itemprop="keywords"><li class="tag-list-item"><a class="tag-list-link" href="/tags/Alist/" rel="tag">Alist</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/NPM/" rel="tag">NPM</a></li></ul>
    </div>
  </div>


    
      
  <div class="widget-wrap widget-recent-posts">
    <div class="widget-title"><span>Recent Posts</span></div>
    <div class="widget-inner">
      <ul>
        
          <li>
            <a href="/posts/7714.html">Hexo部署至云服务器（Git配置）</a>
          </li>
        
          <li>
            <a href="/posts/23045.html">NPM包发布、更新、撤销</a>
          </li>
        
          <li>
            <a href="/posts/56872.html">AList+Aria2+AriaNg私盘利器</a>
          </li>
        
          <li>
            <a href="/posts/16107.html">Hello World</a>
          </li>
        
      </ul>
    </div>
  </div>

    
      
  <div class="widget-wrap widget-archive">
    <div class="widget-title"><span>Archive</span></div>
    <div class="widget-inner">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/">2022</a></li></ul>
    </div>
  </div>


    
</div>

<div id="backtop"><i class="icon icon-arrow-up"></i></div>
            </aside>
            
        </div>
    </div>

    <footer class="footer">
    <div class="footer-wrap">
        <div class="footer-inner"> 
            MENG.ME &copy; 2022
            <!-- <br>
            Powered By Hexo · Theme By <a href="https://linhong.me/" target="_blank">Aomori</a> · <a href="https://github.com/lh1me/hexo-theme-aomori" target="_blank">Github</a> -->
        </div>
    </div>

</footer>

<script type="module" src="https://lib.baomitu.com/ionicons/6.0.2/ionicons/ionicons.esm.js"></script>






<script src="https://npm.elemecdn.com/mengblog@1.0.2/js/build.js?1654266144177.js"></script>


<script src="https://npm.elemecdn.com/mengblog@1.0.2/js/custom.js?1654266144177.js"></script>













</body>

<script src="/dist/meng.js"></script>
</html>